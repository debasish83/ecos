function success = qpdataset(rhoOpt)
    
r = randn(1);
    
%movielens bounds
P = [64.366263, 18.672406, 17.903097, 18.146814, 18.352906, 16.874281, 17.678842, 16.911552, 16.900734, 17.984679, 17.695675, 17.943759, 18.362318, 16.650992, 18.106929, 18.352498, 17.582136, 18.228752, 17.823440, 16.976481; 18.672406, 66.949268, 19.039872, 18.360328, 18.067836, 18.285443, 18.295542, 17.325541, 18.367447, 18.692375, 19.139665, 18.594855, 18.834617, 17.765938, 18.856596, 18.943707, 18.800661, 18.820687, 18.126270, 18.017727; 17.903097, 19.039872, 66.273409, 18.920681, 18.074160, 17.466187, 18.649938, 17.746949, 17.881500, 18.789971, 17.594403, 18.266105, 18.377155, 18.590917, 17.899180, 19.113451, 18.600919, 19.413906, 18.584765, 18.303947; 18.146814, 18.360328, 18.920681, 65.023167, 18.115770, 17.479255, 18.290094, 17.559836, 17.744257, 18.822344, 18.313188, 18.667842, 18.511659, 17.653668, 17.994606, 17.974178, 18.527468, 19.644347, 18.657395, 18.511759; 18.352906, 18.067836, 18.074160, 18.115770, 65.543077, 17.582886, 18.571570, 17.844410, 17.505125, 17.841208, 18.917767, 18.407766, 18.460564, 17.056887, 18.909012, 17.889633, 18.694837, 19.285047, 17.513607, 18.057144; 16.874281, 18.285443, 17.466187, 17.479255, 17.582886, 63.326006, 18.282898, 16.220880, 16.851907, 17.529768, 16.493534, 17.442872, 17.931331, 16.845067, 17.831380, 17.172180, 18.023535, 18.773494, 17.888511, 17.627328; 17.678842, 18.295542, 18.649938, 18.290094, 18.571570, 18.282898, 66.080385, 17.352461, 17.926646, 17.634664, 18.241040, 18.097880, 18.571551, 16.844517, 19.677074, 17.761532, 18.688211, 19.916307, 18.754957, 18.563721; 16.911552, 17.325541, 17.746949, 17.559836, 17.844410, 16.220880, 17.352461, 62.815413, 16.073864, 16.770197, 16.780893, 16.338606, 17.506855, 16.892036, 17.307476, 17.056785, 17.303222, 17.516002, 16.757770, 16.105472; 16.900734, 18.367447, 17.881500, 17.744257, 17.505125, 16.851907, 17.926646, 16.073864, 64.041886, 17.918030, 17.219800, 18.577284, 17.815331, 16.457676, 17.391208, 16.371574, 18.257006, 17.706452, 17.472599, 17.065489; 17.984679, 18.692375, 18.789971, 18.822344, 17.841208, 17.529768, 17.634664, 16.770197, 17.918030, 65.937715, 18.542450, 17.459794, 18.883348, 17.282295, 18.331283, 17.687666, 18.813256, 19.299824, 17.364919, 17.688464; 17.695675, 19.139665, 17.594403, 18.313188, 18.917767, 16.493534, 18.241040, 16.780893, 17.219800, 18.542450, 65.067904, 17.839769, 17.814408, 17.573440, 17.995733, 17.458125, 18.532080, 18.440204, 16.441950, 17.131951; 17.943759, 18.594855, 18.266105, 18.667842, 18.407766, 17.442872, 18.097880, 16.338606, 18.577284, 17.459794, 17.839769, 64.548185, 18.973350, 17.329744, 18.435537, 17.453714, 18.393436, 18.326904, 18.530420, 18.062637; 18.362318, 18.834617, 18.377155, 18.511659, 18.460564, 17.931331, 18.571551, 17.506855, 17.815331, 18.883348, 17.814408, 18.973350, 66.063659, 17.309367, 18.707009, 17.904154, 18.448713, 19.786535, 18.416566, 17.517094; 16.650992, 17.765938, 18.590917, 17.653668, 17.056887, 16.845067, 16.844517, 16.892036, 16.457676, 17.282295, 17.573440, 17.329744, 17.309367, 63.986896, 18.005169, 17.439733, 17.949043, 18.377428, 17.476872, 17.707648; 18.106929, 18.856596, 17.899180, 17.994606, 18.909012, 17.831380, 19.677074, 17.307476, 17.391208, 18.331283, 17.995733, 18.435537, 18.707009, 18.005169, 67.110890, 17.547345, 18.909061, 18.708748, 18.015308, 17.828355; 18.352498, 18.943707, 19.113451, 17.974178, 17.889633, 17.172180, 17.761532, 17.056785, 16.371574, 17.687666, 17.458125, 17.453714, 17.904154, 17.439733, 17.547345, 65.287404, 17.898099, 18.515500, 17.183058, 18.093298; 17.582136, 18.800661, 18.600919, 18.527468, 18.694837, 18.023535, 18.688211, 17.303222, 18.257006, 18.813256, 18.532080, 18.393436, 18.448713, 17.949043, 18.909061, 17.898099, 66.306958, 20.097825, 18.612423, 18.458478; 18.228752, 18.820687, 19.413906, 19.644347, 19.285047, 18.773494, 19.916307, 17.516002, 17.706452, 19.299824, 18.440204, 18.326904, 19.786535, 18.377428, 18.708748, 18.515500, 20.097825, 67.671592, 17.999122, 18.585431; 17.823440, 18.126270, 18.584765, 18.657395, 17.513607, 17.888511, 18.754957, 16.757770, 17.472599, 17.364919, 16.441950, 18.530420, 18.416566, 17.476872, 18.015308, 17.183058, 18.612423, 17.999122, 64.503341, 17.210638; 16.976481, 18.017727, 18.303947, 18.511759, 18.057144, 17.627328, 18.563721, 16.105472, 17.065489, 17.688464, 17.131951, 18.062637, 17.517094, 17.707648, 17.828355, 18.093298, 18.458478, 18.585431, 17.210638, 65.496583];

q = [-399.194974; -417.876313; -419.283499; -412.501237; -411.865119; -388.961727; -416.738016; -385.554691; -398.049377; -411.331199; -402.109376; -409.823922; -414.557526; -394.982928; -409.759726; -397.970812; -414.996864; -428.772464; -399.916208; -405.463240];

P = [614.288341, 558.489236, 569.871041, 578.199543, 564.128413, 585.448801, 587.803624, 583.069435, 576.248178, 570.258234, 575.678878, 593.932906, 574.161974, 564.840343, 577.300453, 557.740224, 585.267837, 570.285940, 577.316269, 568.431342; 558.489236, 653.324133, 580.171749, 598.147022, 575.946984, 600.601916, 609.082707, 597.995186, 587.123210, 584.141066, 591.462908, 607.200960, 591.697846, 576.971679, 600.735810, 577.906908, 607.033997, 588.488183, 591.777323, 579.517749; 569.871041, 580.171749, 691.444353, 600.920565, 616.899424, 638.511352, 609.880927, 633.272454, 623.600671, 620.286920, 610.106547, 644.476412, 609.691222, 614.916740, 600.740280, 580.681792, 606.942755, 611.296529, 626.556302, 617.880863; 578.199543, 598.147022, 600.920565, 690.906979, 594.099111, 621.297454, 630.191598, 615.403057, 607.798107, 604.117216, 613.162352, 627.896285, 608.830732, 595.282679, 619.890660, 595.928556, 624.397864, 606.404819, 612.768829, 602.209738; 564.128413, 575.946984, 616.899424, 594.099111, 684.965180, 633.738209, 603.426675, 631.025100, 618.301207, 616.538152, 606.909699, 640.053466, 608.156850, 613.419796, 598.122462, 576.583425, 603.265389, 608.011998, 622.528606, 613.402530; 585.448801, 600.601916, 638.511352, 621.297454, 633.738209, 731.759087, 631.555004, 655.366712, 643.081871, 641.605295, 632.023334, 668.734594, 628.375753, 634.291939, 621.046844, 598.833840, 626.953447, 630.538055, 647.305984, 640.788220; 587.803624, 609.082707, 609.880927, 630.191598, 603.426675, 631.555004, 711.715132, 623.719447, 618.385678, 612.404027, 621.383621, 638.301817, 619.405541, 603.618091, 630.476341, 604.756777, 635.953724, 615.149923, 621.176661, 611.780285; 583.069435, 597.995186, 633.272454, 615.403057, 631.025100, 655.366712, 623.719447, 725.821722, 639.400197, 636.233800, 627.819264, 662.837657, 628.072575, 633.949305, 618.602770, 597.652580, 623.605362, 628.267869, 642.417814, 635.900166; 576.248178, 587.123210, 623.600671, 607.798107, 618.301207, 643.081871, 618.385678, 639.400197, 707.955083, 622.357409, 615.487611, 651.538945, 612.769736, 622.550859, 605.592657, 587.073570, 614.956347, 612.636227, 628.160937, 624.453648; 570.258234, 584.141066, 620.286920, 604.117216, 616.538152, 641.605295, 612.404027, 636.233800, 622.357409, 697.104704, 614.668701, 647.207880, 613.340392, 616.717561, 603.079864, 583.013538, 607.977156, 614.640293, 630.191357, 621.306868; 575.678878, 591.462908, 610.106547, 613.162352, 606.909699, 632.023334, 621.383621, 627.819264, 615.487611, 614.668701, 687.699558, 639.192253, 613.109455, 607.128308, 613.871928, 590.501856, 618.626497, 611.364188, 622.025394, 613.204516; 593.932906, 607.200960, 644.476412, 627.896285, 640.053466, 668.734594, 638.301817, 662.837657, 651.538945, 647.207880, 639.192253, 746.238020, 636.238267, 641.885519, 627.899365, 606.243303, 633.881088, 637.743288, 653.726792, 648.265314; 574.161974, 591.697846, 609.691222, 608.830732, 608.156850, 628.375753, 619.405541, 628.072575, 612.769736, 613.340392, 613.109455, 636.238267, 686.742087, 606.764561, 613.216487, 589.030272, 616.782278, 612.560186, 621.319517, 613.586917; 564.840343, 576.971679, 614.916740, 595.282679, 613.419796, 634.291939, 603.618091, 633.949305, 622.550859, 616.717561, 607.128308, 641.885519, 606.764561, 687.520890, 597.288971, 578.161749, 602.962411, 606.491089, 621.896149, 614.859915; 577.300453, 600.735810, 600.740280, 619.890660, 598.122462, 621.046844, 630.476341, 618.602770, 605.592657, 603.079864, 613.871928, 627.899365, 613.216487, 597.288971, 693.814532, 597.052716, 627.117316, 608.530916, 613.575541, 600.509852; 557.740224, 577.906908, 580.681792, 595.928556, 576.583425, 598.833840, 604.756777, 597.652580, 587.073570, 583.013538, 590.501856, 606.243303, 589.030272, 578.161749, 597.052716, 647.102763, 603.602391, 585.790051, 589.663072, 578.323071; 585.267837, 607.033997, 606.942755, 624.397864, 603.265389, 626.953447, 635.953724, 623.605362, 614.956347, 607.977156, 618.626497, 633.881088, 616.782278, 602.962411, 627.117316, 603.602391, 703.857160, 611.940356, 616.207116, 606.422179; 570.285940, 588.488183, 611.296529, 606.404819, 608.011998, 630.538055, 615.149923, 628.267869, 612.636227, 614.640293, 611.364188, 637.743288, 612.560186, 606.491089, 608.530916, 585.790051, 611.940356, 682.179363, 621.612791, 610.568450; 577.316269, 591.777323, 626.556302, 612.768829, 622.528606, 647.305984, 621.176661, 642.417814, 628.160937, 630.191357, 622.025394, 653.726792, 621.319517, 621.896149, 613.575541, 589.663072, 616.207116, 621.612791, 707.231303, 626.851707; 568.431342, 579.517749, 617.880863, 602.209738, 613.402530, 640.788220, 611.780285, 635.900166, 624.453648, 621.306868, 613.204516, 648.265314, 613.586917, 614.859915, 600.509852, 578.323071, 606.422179, 610.568450, 626.851707, 704.717524];

q = [-1924.949410; -1972.349510; -2085.392963; -2025.899281; -2066.551113; -2181.660855; -2059.576255; -2160.379569; -2140.345957; -2107.403740; -2065.796495; -2215.124046; -2032.894305; -2106.899796; -2013.068065; -1969.765172; -2033.649599; -2056.966970; -2120.887124; -2099.469956];

%movielens example2

P = [539.101887, 494.598042, 505.700671, 505.846716, 504.700928, 516.629473, 507.958246, 514.096818, 514.801371, 505.735357, 507.322795, 522.547578, 498.320793, 502.829895, 505.847128, 488.934012, 516.116942, 501.906569, 505.627629, 496.409513; 494.598042, 565.723334, 513.239749, 519.155649, 514.070934, 524.154020, 521.694985, 523.512877, 521.122745, 513.862711, 518.653059, 530.426712, 511.054588, 510.096410, 521.373582, 503.132142, 531.736861, 514.161101, 515.005997, 500.799198; 505.700671, 513.239749, 602.920633, 524.780488, 547.978722, 558.807137, 526.999189, 553.273432, 552.657103, 547.690555, 537.912646, 563.616990, 527.634170, 541.947698, 524.060188, 507.650395, 534.403391, 534.406246, 546.625588, 535.221534; 505.846716, 519.155649, 524.780488, 585.686194, 522.548624, 537.124362, 534.911663, 530.505003, 533.364761, 525.544862, 530.149606, 543.063850, 518.884670, 517.707324, 531.252004, 511.635097, 541.217141, 522.706817, 526.063019, 513.574796; 504.700928, 514.070934, 547.978722, 522.548624, 602.711620, 557.824564, 523.454584, 556.453086, 551.975932, 548.308951, 537.908414, 562.811202, 530.685949, 544.687533, 523.961961, 507.966023, 534.868428, 535.823631, 546.491009, 534.209994; 516.629473, 524.154020, 558.807137, 537.124362, 557.824564, 624.863357, 539.305550, 566.795282, 566.357133, 560.044835, 550.021868, 578.832952, 538.509515, 554.979692, 535.459614, 518.812719, 546.530562, 546.168894, 558.181118, 548.792405; 507.958246, 521.694985, 526.999189, 534.911663, 523.454584, 539.305550, 591.413305, 532.696713, 536.852122, 527.232598, 531.751544, 545.578374, 520.832790, 521.212336, 533.128446, 513.908219, 544.084087, 525.037440, 527.089172, 515.549361; 514.096818, 523.512877, 553.273432, 530.505003, 556.453086, 566.795282, 532.696713, 621.615462, 562.996181, 554.493454, 545.658444, 574.476466, 538.757428, 555.556328, 533.365769, 517.189079, 543.997925, 544.795736, 554.632016, 544.157448; 514.801371, 521.122745, 552.657103, 533.364761, 551.975932, 566.357133, 536.852122, 562.996181, 621.891951, 552.016433, 544.239294, 573.926455, 532.639189, 553.095240, 530.294369, 516.269094, 544.643533, 537.922422, 549.757806, 545.057129; 505.735357, 513.862711, 547.690555, 525.544862, 548.308951, 560.044835, 527.232598, 554.493454, 552.016433, 603.860301, 539.638699, 564.591708, 529.636837, 543.558799, 524.759472, 506.968931, 534.506284, 537.156481, 547.911779, 536.271289; 507.322795, 518.653059, 537.912646, 530.149606, 537.908414, 550.021868, 531.751544, 545.658444, 544.239294, 539.638699, 589.023204, 554.623574, 528.460278, 532.243589, 530.559000, 512.720156, 539.864087, 531.591296, 538.972277, 527.533747; 522.547578, 530.426712, 563.616990, 543.063850, 562.811202, 578.832952, 545.578374, 574.476466, 573.926455, 564.591708, 554.623574, 638.367746, 544.269457, 561.616144, 541.245807, 524.820018, 552.498719, 552.102404, 563.397777, 554.806495; 498.320793, 511.054588, 527.634170, 518.884670, 530.685949, 538.509515, 520.832790, 538.757428, 532.639189, 529.636837, 528.460278, 544.269457, 576.086269, 524.503702, 521.427126, 503.797286, 531.685079, 525.230922, 529.783815, 520.222911; 502.829895, 510.096410, 541.947698, 517.707324, 544.687533, 554.979692, 521.212336, 555.556328, 553.095240, 543.558799, 532.243589, 561.616144, 524.503702, 597.742352, 520.329969, 504.306186, 530.688065, 531.679956, 541.233986, 531.982099; 505.847128, 521.373582, 524.060188, 531.252004, 523.961961, 535.459614, 533.128446, 533.365769, 530.294369, 524.759472, 530.559000, 541.245807, 521.427126, 520.329969, 586.613767, 513.362642, 542.438988, 524.690396, 526.354706, 511.243067; 488.934012, 503.132142, 507.650395, 511.635097, 507.966023, 518.812719, 513.908219, 517.189079, 516.269094, 506.968931, 512.720156, 524.820018, 503.797286, 504.306186, 513.362642, 550.229150, 523.966242, 506.244433, 507.769334, 495.459277; 516.116942, 531.736861, 534.403391, 541.217141, 534.868428, 546.530562, 544.084087, 543.997925, 544.643533, 534.506284, 539.864087, 552.498719, 531.685079, 530.688065, 542.438988, 523.966242, 606.957114, 533.719037, 534.295092, 522.409881; 501.906569, 514.161101, 534.406246, 522.706817, 535.823631, 546.168894, 525.037440, 544.795736, 537.922422, 537.156481, 531.591296, 552.102404, 525.230922, 531.679956, 524.690396, 506.244433, 533.719037, 583.853405, 536.033903, 522.009144; 505.627629, 515.005997, 546.625588, 526.063019, 546.491009, 558.181118, 527.089172, 554.632016, 549.757806, 547.911779, 538.972277, 563.397777, 529.783815, 541.233986, 526.354706, 507.769334, 534.295092, 536.033903, 599.942302, 535.001472; 496.409513, 500.799198, 535.221534, 513.574796, 534.209994, 548.792405, 515.549361, 544.157448, 545.057129, 536.271289, 527.533747, 554.806495, 520.222911, 531.982099, 511.243067, 495.459277, 522.409881, 522.009144, 535.001472, 593.140288];

q = [-1880.240029; -1920.949941; -2030.476172; -1956.642164; -2021.502985; -2090.503157; -1965.934820; -2072.855628; -2098.075034; -2035.059185; -1999.005923; -2121.515181; -1944.759586; -2035.397706; -1939.872057; -1888.635008; -1986.031605; -1973.738457; -2024.468051; -2003.765736];

lb = zeros(20, 1);
ub = ones(20, 1);

%Add MOSEK path
addpath /home/debasish/mosek/7/toolbox/r2013a/
tic;
mosekx = quadprog(P, q, [], [], [], [], lb, ub);
mosekTime = toc;
fprintf('mosek done\n');

%Add ECOS path
addpath /home/debasish/ecos/matlab
[ecosx, ~, ~, ~, ~, ecosTime] = ecosqp(P,q,[],[],[],[],lb,ub, ecosoptimset('verbose', 0, 'feastol', 1e-8));
    
lambdaMin = eigs(P, 1, 'SA');
lambdaMax = eigs(P, 1, 'LA');

rhoEig = sqrt(lambdaMin*lambdaMax);

minElem = min(min(P));
norm1 = norm(P, 1);
normInf = norm(P, Inf);
norm2 = norm(P, 2);

rhoNorm = sqrt(norm1);

if (rhoOpt == 1)
    rho = rhoEig;
else 
    rho = rhoNorm;
end
    
tic;
[x history] = qpproximal(P, q, r, lb, ub, rho, 1.0);
admmTime = toc;

tic;
[accx history] = qpaccelerated(P, q, r, lb, ub, rho);
admmAcceleratedTime = toc;

fprintf('mosek-ecos norm %g\n', norm(mosekx - ecosx));
fprintf('mosek-admm norm %g\n', norm(mosekx - x));
fprintf('mosek-admmacc norm %g\n', norm(mosekx - accx));

fprintf('cond(P) %g\n', cond(P));
fprintf('lambdaMin %g lambdaMax %g\n', lambdaMin, lambdaMax);

fprintf('rho %g\n', rho);
fprintf('minElem %g norm1 %g norm2 %g normInf %g rhoNorm %g\n', minElem, norm1, norm2, normInf, rhoNorm);
fprintf('mosek %g ecos %g admm %g admmfast %g\n', mosekTime, ecosTime, admmTime, admmAcceleratedTime);

end
