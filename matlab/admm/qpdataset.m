r = randn(1);

P = [38.077435, 23.407282, 23.540553, 22.946151, 23.327740, 25.199670, 23.109079, 24.184646, 23.892053, 24.365952, 22.536322, 23.737349, 24.255463, 22.472864, 24.998369, 22.991598, 22.738501, 25.470983, 23.533342, 22.900306, 23.105235, 24.244195, 23.594771, 23.879256, 23.621407; 23.407282, 36.886696, 23.985326, 22.499704, 22.964198, 24.418663, 22.883356, 23.145492, 23.449108, 24.424576, 22.556203, 22.678561, 23.672048, 21.581091, 24.329815, 23.222787, 22.500865, 24.333068, 22.919012, 22.650423, 23.492775, 23.978601, 23.050917, 23.934307, 23.882415; 23.540553, 23.985326, 37.899946, 23.635920, 23.719949, 24.180224, 23.569627, 24.231197, 23.490126, 24.496969, 23.812907, 23.929317, 23.726246, 21.811095, 24.556764, 23.067664, 23.084189, 24.907031, 23.291899, 23.723789, 23.950494, 25.267634, 22.793498, 24.574518, 23.508335; 22.946151, 22.499704, 23.635920, 36.877113, 23.069513, 23.413965, 22.143392, 24.173862, 22.734327, 22.560689, 22.240388, 22.520270, 23.128219, 21.148686, 24.173433, 22.071975, 22.414236, 24.409717, 22.679115, 22.855034, 22.953796, 24.268865, 22.054854, 23.114754, 23.189423; 23.327740, 22.964198, 23.719949, 23.069513, 37.134098, 24.050294, 23.044200, 23.668591, 23.256412, 24.338999, 22.184036, 23.095143, 23.982391, 21.486913, 24.068848, 22.438426, 22.648566, 24.286928, 22.830156, 23.661874, 22.380275, 24.182303, 21.986712, 23.533821, 23.356316; 25.199670, 24.418663, 24.180224, 23.413965, 24.050294, 40.054794, 23.618100, 23.576253, 24.581649, 25.166348, 23.984594, 24.336717, 25.004360, 22.961894, 25.981415, 23.099150, 22.978814, 26.157206, 24.048413, 23.704089, 24.040740, 24.769053, 23.204278, 25.481359, 24.741853; 23.109079, 22.883356, 23.569627, 22.143392, 23.044200, 23.618100, 36.626200, 22.438241, 23.010621, 22.864012, 23.424582, 23.465990, 22.201856, 20.844253, 24.878665, 23.106159, 22.627422, 24.186898, 22.621091, 23.536157, 23.306192, 23.932782, 22.504187, 23.951326, 23.881519; 24.184646, 23.145492, 24.231197, 24.173862, 23.668591, 23.576253, 22.438241, 38.735876, 23.246619, 25.015228, 23.399304, 24.227069, 23.720481, 22.295313, 24.651771, 22.570611, 22.445044, 24.432202, 23.415613, 23.437123, 24.084812, 24.679504, 22.566659, 24.624950, 23.690572; 23.892053, 23.449108, 23.490126, 22.734327, 23.256412, 24.581649, 23.010621, 23.246619, 38.056742, 23.901840, 22.438214, 22.885906, 23.625434, 22.047994, 24.216541, 23.172188, 21.944664, 24.101953, 23.312157, 22.254254, 23.380226, 23.813059, 22.664812, 23.764001, 23.106271; 24.365952, 24.424576, 24.496969, 22.560689, 24.338999, 25.166348, 22.864012, 25.015228, 23.901840, 40.101113, 23.504326, 24.421168, 23.889632, 23.027574, 24.347993, 24.438850, 23.582941, 25.057128, 24.441755, 24.905095, 23.591949, 25.373990, 23.490592, 25.246793, 25.334698; 22.536322, 22.556203, 23.812907, 22.240388, 22.184036, 23.984594, 23.424582, 23.399304, 22.438214, 23.504326, 35.579097, 23.998444, 22.380668, 20.975250, 23.169298, 22.435353, 21.783180, 24.195574, 22.825998, 22.308179, 23.573444, 24.117264, 22.531989, 23.617098, 22.599537; 23.737349, 22.678561, 23.929317, 22.520270, 23.095143, 24.336717, 23.465990, 24.227069, 22.885906, 24.421168, 23.998444, 36.070439, 23.666731, 21.726323, 24.890380, 22.773284, 22.380557, 23.958411, 23.475713, 23.819519, 23.087254, 24.367946, 22.731905, 24.462779, 23.442223; 24.255463, 23.672048, 23.726246, 23.128219, 23.982391, 25.004360, 22.201856, 23.720481, 23.625434, 23.889632, 22.380668, 23.666731, 37.765632, 22.231424, 24.555066, 22.637865, 21.828379, 24.730576, 22.955329, 23.211584, 23.141465, 24.557037, 22.734077, 23.573207, 24.944784; 22.472864, 21.581091, 21.811095, 21.148686, 21.486913, 22.961894, 20.844253, 22.295313, 22.047994, 23.027574, 20.975250, 21.726323, 22.231424, 33.361718, 22.710267, 21.805389, 20.484254, 23.324462, 21.747992, 21.591565, 21.293016, 23.619579, 21.571386, 22.334025, 22.217774; 24.998369, 24.329815, 24.556764, 24.173433, 24.068848, 25.981415, 24.878665, 24.651771, 24.216541, 24.347993, 23.169298, 24.890380, 24.555066, 22.710267, 41.616949, 23.632164, 22.670449, 25.512020, 23.690511, 24.737026, 23.592036, 24.922144, 24.615818, 24.569405, 24.974313; 22.991598, 23.222787, 23.067664, 22.071975, 22.438426, 23.099150, 23.106159, 22.570611, 23.172188, 24.438850, 22.435353, 22.773284, 22.637865, 21.805389, 23.632164, 36.811531, 22.385597, 24.287131, 23.626886, 22.795521, 22.677508, 23.825348, 22.524474, 23.814680, 23.058835; 22.738501, 22.500865, 23.084189, 22.414236, 22.648566, 22.978814, 22.627422, 22.445044, 21.944664, 23.582941, 21.783180, 22.380557, 21.828379, 20.484254, 22.670449, 22.385597, 33.618949, 23.203640, 22.400453, 21.433282, 22.371152, 24.044771, 22.285753, 22.789674, 22.119499; 25.470983, 24.333068, 24.907031, 24.409717, 24.286928, 26.157206, 24.186898, 24.432202, 24.101953, 25.057128, 24.195574, 23.958411, 24.730576, 23.324462, 25.512020, 24.287131, 23.203640, 41.500636, 24.157372, 24.583134, 24.400678, 26.171223, 23.700874, 25.572100, 24.256519; 23.533342, 22.919012, 23.291899, 22.679115, 22.830156, 24.048413, 22.621091, 23.415613, 23.312157, 24.441755, 22.825998, 23.475713, 22.955329, 21.747992, 23.690511, 23.626886, 22.400453, 24.157372, 36.621887, 23.074774, 23.574636, 24.157034, 22.678506, 24.453585, 24.085705; 22.900306, 22.650423, 23.723789, 22.855034, 23.661874, 23.704089, 23.536157, 23.437123, 22.254254, 24.905095, 22.308179, 23.819519, 23.211584, 21.591565, 24.737026, 22.795521, 21.433282, 24.583134, 23.074774, 37.107643, 22.614622, 24.548795, 22.205775, 23.868659, 23.631542; 23.105235, 23.492775, 23.950494, 22.953796, 22.380275, 24.040740, 23.306192, 24.084812, 23.380226, 23.591949, 23.573444, 23.087254, 23.141465, 21.293016, 23.592036, 22.677508, 22.371152, 24.400678, 23.574636, 22.614622, 37.783198, 24.538578, 22.848301, 24.458232, 23.100103; 24.244195, 23.978601, 25.267634, 24.268865, 24.182303, 24.769053, 23.932782, 24.679504, 23.813059, 25.373990, 24.117264, 24.367946, 24.557037, 23.619579, 24.922144, 23.825348, 24.044771, 26.171223, 24.157034, 24.548795, 24.538578, 39.641631, 24.081651, 24.949905, 24.183932; 23.594771, 23.050917, 22.793498, 22.054854, 21.986712, 23.204278, 22.504187, 22.566659, 22.664812, 23.490592, 22.531989, 22.731905, 22.734077, 21.571386, 24.615818, 22.524474, 22.285753, 23.700874, 22.678506, 22.205775, 22.848301, 24.081651, 35.766247, 24.113752, 23.470364; 23.879256, 23.934307, 24.574518, 23.114754, 23.533821, 25.481359, 23.951326, 24.624950, 23.764001, 25.246793, 23.617098, 24.462779, 23.573207, 22.334025, 24.569405, 23.814680, 22.789674, 25.572100, 24.453585, 23.868659, 24.458232, 24.949905, 24.113752, 38.413349, 24.361637; 23.621407, 23.882415, 23.508335, 23.189423, 23.356316, 24.741853, 23.881519, 23.690572, 23.106271, 25.334698, 22.599537, 23.442223, 24.944784, 22.217774, 24.974313, 23.058835, 22.119499, 24.256519, 24.085705, 23.631542, 23.100103, 24.183932, 23.470364, 24.361637, 38.891080];

q = [-609.918652; -602.022149; -613.673313; -595.808974; -602.159346; -630.243002; -604.652162; -619.625778; -610.785237; -632.016399; -593.679281; -607.046058; -614.401018; -570.680136; -637.844245; -594.948189; -573.651467; -645.880723; -599.171773; -606.244619; -606.203188; -639.237541; -600.718614; -628.845046; -610.955998];

lb = zeros(25, 1);
ub = ones(25, 1)
    
%Add MOSEK path
addpath /home/debasish/mosek/7/toolbox/r2013a/
tic;
mosekx = quadprog(P, q, [], [], [], [], lb, ub);
mosekTime = toc;
fprintf('mosek done\n');

%Add ECOS path
addpath /home/debasish/ecos/matlab
[ecosx, ~, ~, ~, ~, ecosTime] = ecosqp(P,q,[],[],[],[],lb,ub, ecosoptimset('verbose', 0, 'feastol', 1e-8));

tic;
[x history] = qpproximal(P, q, r, lb, ub, 10.0, 1.0);
admmTime = toc;

tic;
[accx history] = qpaccelerated(P, q, r, lb, ub, 10.0, 1.0);
admmAcceleratedTime = toc;

fprintf('mosek-ecos norm %g\n', norm(mosekx - ecosx));
fprintf('mosek-admm norm %g\n', norm(mosekx - x));
fprintf('mosek-admmacc norm %g\n', norm(mosekx - accx));

fprintf('mosek %g ecos %g admm %g admmfast %g\n', mosekTime, ecosTime, admmTime, admmAcceleratedTime);
